"use strict";var TwitchViewer=function(e){var s=[],a={};return localStorage.hasOwnProperty("userList")?(console.log("Found Local List"),s=localStorage.getItem("userList").split(", "),console.log(s)):(console.log("Initializing List"),localStorage.setItem("userList",e),s=e.split(", ")),{createUserObj:function(e){var s=$('<div class="collapse-user collapse">'),t=$('<div class="user-container">'),l=$('<a class="user" target="_blank" rel="noopener noreferrer" href="https://www.twitch.tv/'+e+'">');l.append($('<div class="user-logo">').append($("<img>"))),l.append($('<div class="user-text">').append($('<h4 class="display-name"></h4><p class="user-status"></p><p class="user-game"></p>'))),t.append(l),t.append($('<div class="user-remove">').append($('<a class="x" href="#"><i class="fa fa-times-circle" aria-hidden="true"></i></a>'))),s.append(t),a[e]={collapser:s,logo:s.find("img"),displayName:s.find(".display-name"),status:s.find(".user-status"),game:s.find(".user-game"),isOnline:null}},deleteUser:function(e){var t=$(e).closest(".collapse-user"),l=$(e).closest(".user-container").find("h4").html().toLowerCase();s.splice(s.indexOf(l),1),delete a[l],localStorage.setItem("userList",s.join(", ")),t.collapse("hide"),setTimeout(function(){$(t).remove()},5e3)},resetLocalList:function(){localStorage.setItem("userList",e),s=e.split(", "),location.reload()},parseUserData:function(e,s){var t=($('<div class="collapse-user collapse">'),$('<div class="user-container">'),""),l="",n=0;if(s){var r=e.stream.channel.logo,o=e.stream.channel.name,i=a[o];i.logo.attr({src:r,alt:o+" avatar"}),t=e.stream.channel.status||"",l=e.stream.game?"Streaming: "+e.stream.game:"",n=e.stream.viewers?e.stream.viewers+" viewers":0,i.displayName.text(e.stream.channel.display_name),i.status.text(t),i.game.text(l+" - "+n),null===i.isOnline&&(i.isOnline=!0,$("#users-online").append(i.collapser),i.collapser.collapse("show"))}else if(s===!1){var r=e.logo,o=e.name,i=a[o];i.logo.attr({src:r,alt:o+" avatar"}),t=e.status||"",i.displayName.text(e.display_name),i.status.text(t),null===i.isOnline&&(i.isOnline=!1,$("#users-offline").append(i.collapser),i.collapser.collapse("show"))}else{var i=a[e];i.logo.attr({src:"images/default_avatar.png",alt:"default avatar"}),t=e.status||"",i.displayName.text(e),i.status.html('<p class="null-status">This user no longer exists.</p>'),null===i.isOnline&&(i.isOnline=!1,$("#users-offline").append(i.collapser),i.collapser.collapse("show"))}},getOfflineUser:function(e){var s=this;$.ajax({dataType:"jsonp",url:e,success:function(e){s.parseUserData(e,!1)},error:function(e){console.log(e)}})},updateUserList:function(){var e=this;$.each(s,function(s,a){$.ajax({dataType:"jsonp",url:"https://api.twitch.tv/kraken/streams/"+a,success:function(s){s.hasOwnProperty("error")?e.parseUserData(a,null):null===s.stream?e.getOfflineUser(s._links.channel):e.parseUserData(s,!0)},error:function(e){console.log(e)}})})},init:function(){var e=this;$.each(s,function(s,a){e.createUserObj(a)}),e.updateUserList()}}};$(document).ready(function(){var e="esl_sc2, ogamingsc2, cretetion, freecodecamp, storbeck, habathcx, robotcaleb, noobs2ninjas, brunofin, comster404",s=new TwitchViewer(e);s.init(),$("#btn-online").on("click",function(e){e.preventDefault(),$("#caret-online").toggleClass("open")}),$("#btn-offline").on("click",function(e){e.preventDefault(),$("#caret-offline").toggleClass("open")}),$("#collapse-user-list").on("click","a.user",function(e){this.blur()}),$("#collapse-user-list").on("click",".user-remove>a",function(e){e.preventDefault(),s.deleteUser(this)}),$("#btn-reset").on("click",function(e){s.resetLocalList()})});